import{_ as P,V as v,d as k,l as M,z as D,c as A,F,a as S,E as B,q as x,m as b,u as C,b as y,e as s,n as r,f as o,w as g,x as U,k as E,r as h,o as _,g as V,t as W,p as q,h as N}from"./index-whPr3vNV.js";import{p as j,S as u}from"./postsStore-EsgWh2CI.js";Object.keys(v).forEach(l=>{k(l,v[l])});M({zhTW:D});A({generateMessage:M("zhTW"),validateOnInput:!0});const z={components:{VForm:F,VField:S,ErrorMessage:B},data(){return{currentUserData:JSON.parse(x.get("MetaWall_user")),selectedFile:null,modifyMode:"modifyUser",modifyAreaData:{name:"",sex:""},editPassword:{password:""},checkPassword:"",passwordErrorMessage:""}},methods:{...b(j,["toUploadPost"]),...b(C,["changePassword","editUser"]),async upLoadimage(l){const e=l.target.files[0];e&&(this.selectedFile=e,console.log(this.selectedFile),this.toUploadPost(this.selectedFile).then(f=>{console.log(f);const c=f.data.fileUrl;console.log(c),this.editUser(this.currentUserData._id,{photo:c}).then(()=>{this.currentUserData.photo=c,x.set("MetaWall_user",JSON.stringify(this.currentUserData),{expires:7})})}))},async editUserBtn(){(await this.editUser(this.currentUserData._id,this.modifyAreaData)).status===200?u.fire({icon:"success",title:"會員編輯成功"}).then(()=>{this.$router.push("/community/postArea")}):u.fire({icon:"error",title:"發生錯誤",text:"請稍後嘗試"})},async editPasswordBtn(){this.editPassword.password===this.checkPassword?(this.passwordErrorMessage="",(await this.editUser(this.currentUserData._id,this.editPassword)).status===200?u.fire({icon:"success",title:"密碼修改成功"}).then(()=>{this.$router.push("/community/postArea")}):u.fire({icon:"error",title:"發生錯誤",text:"請稍後嘗試"})):this.passwordErrorMessage="檢查密碼不正確"}}},n=l=>(q("data-v-688de250"),l=l(),N(),l),I=n(()=>s("section",{class:"title position-relative d-flex justify-content-center align-items-center mb-5"},[s("h3",null,"修改個人資料")],-1)),O={class:"modifySwitchBtn ms-3 d-flex"},T={class:"modifyArea"},J={key:0,class:"modifyUser m-5"},L={class:"d-flex flex-column justify-content-center align-items-center"},R={class:"imgContainer mx-1"},G=["src"],H=n(()=>s("label",{for:"photoFile",class:"photoFile m-2 px-4 py-1"},"上傳大頭照",-1)),K={class:"d-flex flex-column justify-content-center align-items-center"},Q=n(()=>s("label",{for:"name",class:"my-2"},"暱稱",-1)),X=n(()=>s("p",{class:"my-2"},"性別",-1)),Y=n(()=>s("label",{for:"male",class:"mx-1"},"男性",-1)),Z=n(()=>s("label",{for:"female",class:"mx-1"},"女性",-1)),$=n(()=>s("label",{for:"other",class:"mx-1"},"其他",-1)),ee=n(()=>s("button",{type:"submit",class:"btn MetaWall_button btnShdow w-100 my-4 px-4"},"送出更新",-1)),se={key:1,class:"modifyPassword m-5"},te={class:"d-flex flex-column justify-content-center align-items-center"},oe=n(()=>s("label",{for:"name",class:"my-2"},"請輸入密碼",-1)),ae=n(()=>s("label",{for:"name",class:"my-2"},"請再次輸入密碼",-1)),le=n(()=>s("button",{type:"submit",class:"btn MetaWall_button btnShdow w-100 my-4 px-4"},"送出更新",-1)),ie={class:"errorMessage text-center"};function ne(l,e,f,c,t,p){const d=h("v-field"),m=h("error-message"),w=h("v-form");return _(),y(E,null,[I,s("section",null,[s("div",O,[s("button",{class:r(["btn modifyBtn px-4",{modifyBtnActive:t.modifyMode==="modifyUser"}]),onClick:e[0]||(e[0]=a=>t.modifyMode="modifyUser")},"暱稱修改",2),s("button",{class:r(["btn modifyBtn px-4",{modifyBtnActive:t.modifyMode==="modifyPassword"}]),onClick:e[1]||(e[1]=a=>t.modifyMode="modifyPassword")},"重設密碼",2)]),s("div",T,[t.modifyMode==="modifyUser"?(_(),y("form",J,[s("div",L,[s("div",R,[s("img",{src:t.currentUserData.photo,alt:"userPhoto"},null,8,G)]),H,s("input",{id:"photoFile",class:"d-none",type:"file",onChange:e[2]||(e[2]=a=>p.upLoadimage())},null,32)]),s("div",K,[o(w,{class:"d-flex flex-column vForm",onSubmit:e[7]||(e[7]=a=>p.editUserBtn())},{default:g(({errors:a})=>[Q,o(d,{id:"name",name:"暱稱",type:"text",class:r(["MetaWall_input my-1",{"is-invalid":a.暱稱}]),placeholder:"請輸入暱稱",rules:"required",modelValue:t.modifyAreaData.name,"onUpdate:modelValue":e[3]||(e[3]=i=>t.modifyAreaData.name=i)},null,8,["class","modelValue"]),o(m,{name:"暱稱",class:"invalid-feedback"}),X,s("div",null,[o(d,{id:"male",name:"性別",type:"radio",class:r({"is-invalid":a.性別}),value:"male",rules:"required",modelValue:t.modifyAreaData.sex,"onUpdate:modelValue":e[4]||(e[4]=i=>t.modifyAreaData.sex=i)},null,8,["class","modelValue"]),Y,V("   "),o(d,{id:"female",name:"性別",type:"radio",class:r({"is-invalid":a.性別}),value:"female",rules:"required",modelValue:t.modifyAreaData.sex,"onUpdate:modelValue":e[5]||(e[5]=i=>t.modifyAreaData.sex=i)},null,8,["class","modelValue"]),Z,V("   "),o(d,{id:"other",name:"性別",type:"radio",class:r({"is-invalid":a.性別}),value:"other",rules:"required",modelValue:t.modifyAreaData.sex,"onUpdate:modelValue":e[6]||(e[6]=i=>t.modifyAreaData.sex=i)},null,8,["class","modelValue"]),$,o(m,{name:"性別",class:"invalid-feedback"})]),o(m,{name:"密碼",class:"invalid-feedback"}),ee]),_:1})])])):U("",!0),t.modifyMode==="modifyPassword"?(_(),y("form",se,[s("div",te,[o(w,{class:"d-flex flex-column vForm",onSubmit:e[10]||(e[10]=a=>p.editPasswordBtn())},{default:g(({errors:a})=>[oe,o(d,{id:"password",name:"密碼",type:"password",class:r(["MetaWall_input my-1",{"is-invalid":a.密碼}]),placeholder:"請輸入密碼",rules:"min:8|required",modelValue:t.editPassword.password,"onUpdate:modelValue":e[8]||(e[8]=i=>t.editPassword.password=i)},null,8,["class","modelValue"]),o(m,{name:"密碼",class:"invalid-feedback"}),ae,o(d,{id:"checkPassword",name:"檢查密碼",type:"password",class:r(["MetaWall_input my-1",{"is-invalid":a.檢查密碼}]),placeholder:"請再次輸入密碼",rules:"min:8|required",modelValue:t.checkPassword,"onUpdate:modelValue":e[9]||(e[9]=i=>t.checkPassword=i)},null,8,["class","modelValue"]),o(m,{name:"檢查密碼",class:"invalid-feedback"}),le,s("p",ie,W(t.passwordErrorMessage),1)]),_:1})])])):U("",!0)])])],64)}const me=P(z,[["render",ne],["__scopeId","data-v-688de250"]]);export{me as default};
